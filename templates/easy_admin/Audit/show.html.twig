{% extends '@EasyAdmin/default/show.html.twig' %}

{% block content_title %}
	{{ parent() }}
	{{ entity.date|date("d/m/Y") }} (<a href="{{ path('easyadmin', { action: 'show', entity: 'Magasin', id: entity.magasin.id, referer: '' }) }}">{{ entity.magasin }}</a>)
	{% set field_options = {'colors': statut_audit_colors, 'label': 'audit.statut' } %}
	{% include  'easy_admin/choice_list.html.twig' with {'field_options': field_options, 'value': entity.statut } %}
{% endblock %}

{% block main %}
	<div class="form-horizontal">
	{% for rayon_magasin in entity.magasin.rayonsMagasins %}
		<div class="box box-primary box-solid" style="border-color:{{ rayon_magasin.rayon.couleur }};">
			<div class="box-header with-border" style="background-color:{{ rayon_magasin.rayon.couleur }};">
				<h3 class="box-title">{{ rayon_magasin.rayon }}</h3>
				<div class="box-tools pull-right">
	            	<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
	            </div>
			</div>
			<div class="box-body">
                <div class="box-group" id="accordion{{ rayon_magasin.id }}">
                    {% for zone in rayon_magasin.zones %}
                    <div class="panel box">
                        <div class="box-header with-border">
                            <h4 class="box-title" style="display:block;">
                                <a data-toggle="collapse" data-parent="#accordion{{ rayon_magasin.id }}" href="#collapse{{ rayon_magasin.id }}{{zone.id}}" style="display:block; color:{{ rayon_magasin.rayon.couleur }};">{{ zone.nom }}</a>
                            </h4>
                        </div>
                        <div id="collapse{{ rayon_magasin.id }}{{zone.id}}" class="panel-collapse collapse">
                            <div class="box-body">
                                <ul class="todo-list">
                                {% for item in zone.items %}
                                    <li class="bg-grey disabled">
                                        <div class="btn_audit btn-group btn-group-sm">
                                            <button type="button" class="btn btn-sm btn-default c"><i class="fa fa-check"></i></button>
                                            <button type="button" class="btn btn-sm btn-default nc"><i class="fa fa-close"></i></button>
                                            <button type="button" class="btn btn-sm btn-default ne"><i class="fa fa-eye-slash"></i></button>
                                        </div>
                                        <span class="text">{{ item.nom }}</span>
                                        
                                        <!-- Emphasis label -->
                                        <small class="label label-info"><i class="fa fa-clock-o"></i> 2 mins</small>
                                        <!-- General tools such as edit or delete-->
                                        <div class="tools">
                                            <i class="fa fa-edit edit_item"></i>
                                            <i class="fa fa-trash-o"></i>
                                        </div>
                                    </li>
                                {% endfor %}
                                </ul>                                
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
		</div>
	{% endfor %}
	</div>
{% endblock %}

{% block body_javascript %}
	{{ parent() }}
    
    <script type="text/javascript">
        $(function() {
            $('.btn_audit > .btn').click(function() {
                //send ajax request

                var li_class = "";
                if($(this).hasClass("c")) li_class = "bg-green";
                if($(this).hasClass("nc")) li_class = "bg-red";
                if($(this).hasClass("ne")) li_class = "bg-grey";
                console.log(li_class);

                $(this).parent().children().removeClass("actif");
                $(this).addClass( "actif" );
                $(this).parents("li").removeClass();
                $(this).parents("li").addClass(li_class);
            });

			$('.edit_item').click(function() {
                $.ajax({
                    type: 'POST',
                    url: '{{ path("audit_ajax") }}',
                    /*data: {
                        'entity': '{{ _entity_config.name }}',
                        'id': $(this).data('id')
                    }*/
                    success: function(response) {
                        console.log(response);
                    }
                });
            });
        });
    </script>

{% endblock body_javascript %}